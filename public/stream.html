<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ZegoCloud Test</title>
</head>
<body>
  <h2>ZegoCloud Test</h2>
  <div id="video-container" style="width: 640px; height: 360px;"></div>

  <script src="https://unpkg.com/zego-express-engine-webrtc@latest/sdk/ZegoExpressEngine.min.js"></script>
  <script>
    async function startZegoStream() {
      const res = await fetch('/stream-info');
      const data = await res.json();

      const zg = new ZegoExpressEngine(data.appID, data.appSign);

      try {
        await zg.loginRoom(data.roomID, 1, {
          userID: data.userID,
          userName: data.userName
        });

        const localStream = await zg.createStream();
        zg.startPublishingStream(data.roomID, localStream);

        const container = document.getElementById('video-container');
        zg.startPlayingStream(data.roomID, { container });
        console.log("✅ Zego Connected");
      } catch (e) {
        console.error("❌ Zego Error:", e);
      }
    }

    startZegoStream();
  </script>
</body>
</html>
